version: "3.9"

services:
  redis:
    image: redis:7-alpine
    container_name: stocks_redis
    ports:
      - "6379:6379"

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: stocks_backend
    depends_on:
      - redis
    environment:
      # Redis inside Docker is reachable at hostname "redis"
      REDIS_URL: "redis://redis:6379/0"

      # Optional: set these here or via .env file (see next step)
      FINNHUB_TOKEN: "${FINNHUB_TOKEN}"
      WEBEX_BOT_TOKEN: "YzIxMTM1NTItYjE5Zi00Y2VmLTg0ZDMtZjI0YzBiNWEwNDM1YTY3MjI1MjktYWQ0_P0A1_e58072af-9d57-4b13-abf7-eb3b506c964d"
      WEBEX_ROOM_ID: "Y2lzY29zcGFyazovL3VybjpURUFNOnVzLXdlc3QtMl9yL1JPT00vN2Q0YjkxOTAtY2Q2OS0xMWYwLThmNmUtYjMzMTlmODMwYTM4"
    ports:
      - "8000:8000"

  frontend:
    image: nginx:alpine
    container_name: stocks_frontend
    depends_on:
      - backend
    volumes:
      # Serve your static files from /usr/share/nginx/html
      - ./frontend:/usr/share/nginx/html:ro
    ports:
      - "8080:80"
